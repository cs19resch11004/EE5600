\documentclass[journal,12pt,twocolumn]{IEEEtran}

\usepackage{graphicx}
\graphicspath{ {./5609/Assign6/} }

\makeatletter
\newcommand\xleftrightarrow[2][]{%
  \ext@arrow 9999{\longleftrightarrowfill@}{#1}{#2}}
\newcommand\longleftrightarrowfill@{%
  \arrowfill@\leftarrow\relbar\rightarrow}
\makeatother


\newcommand\leftarrowS{\leftarrow\joinrel\smalldollar}
\newcommand\rightarrowS{\smalldollar\joinrel\rightarrow}


\usepackage{amsmath}
\newcommand{\myvec}[1]{\ensuremath{\begin{pmatrix}#1\end{pmatrix}}}
\title{Assignment 6}
\author{PARIMISETTY HARINADHA (CS19RESCH11004)}
\begin{document}
\maketitle
\newpage
\begin{abstract}
This Document demonstrate a method to  find the foot perpendicular  from a given point to a given plane using Singular Value Decomposition.
\end{abstract}
Download all python codes from 
\framebox[1\width]{ https://github.com/cs19resch11004/hari }
Download all Latex-tikz codes from 
\framebox[1.1\width]{ https://github.com/cs19resch11004/hari} 
\section{\textbf{Problem}}
Write the equation of a plane through the point A $\left(-3, 4, -1 \right)$ and perpendicular to the line 
\begin{align}
\frac{x+2}{-3} = \frac{y - 2}{1} = \frac{z-4}{2} \label{eq:1}
\end{align}
\section{\textbf{Solution}} 
 Let the equation of plane is 
 \begin{align}
 ax +by +cz +d = 0 \label{eq:2}
 \end{align}
Direction ratio of the line \eqref{eq:1} is given as 
  \begin{align}
  D = \myvec{-3 \\ 1 \\ 2}
  \end{align}

  \begin{align}
  \intertext{ Now let consider } 
  A = \myvec{-3 & 4 & -1} 
  \intertext{Since plane is passing through the point A (-3, 4, -1 ) and perpendicular to the line \eqref{eq:1}, hence}
  AD + d = 0 \\
  \implies d = -11
   \end{align}
Hence equation of the plane is 
  \begin{align}
  -3x + y + 2z - 11 = 0 \\
  \implies -3x + y + 2z = 11 \label{eq:8}
  \end{align} 
equation \eqref{eq:8} can written as :
  \begin{align}
  \myvec{-3 & 1 & 2}x = 11
  \end{align}

For finding the foot of perpendicular from point $D$$\left(-2, 2, 4 \right)$ to the plane $\myvec{-3 & 1 & 2}x = 11$ using SVD, we need to represent the equation of plane in parametric form,
\begin{align}
	Q = p + \alpha_1m_1 + \alpha_2m_2 \label{eq:10}
\end{align}
Here $p$$\left(-3, 4, -1 \right)$ is a point on plane and $m_1, m_2$ are two vectors parallel to plane and hence $\perp$ to $n$.
First we find orthogonal vectors $m_1$ and $m_2$ to the vector $n$. Let, $m = \myvec{a\\b\\c}$, then
\begin{align}
m^Tn &= 0 \nonumber \\
\implies \myvec{a & b & c} \myvec{-3 \\ 1 \\ 2} &= 0 \nonumber \\
\implies -3a+b+2c &= 0 \label{eq:11}
\intertext{Putting a=1 and b=0 we get,}
m_1 &= \myvec{1\\0\\\frac{3}{2} }\\
\intertext{Putting a=0 and b=1 we get,}
m_2 &= \myvec{0\\1\\ -\frac{1}{2}}
\end{align}
Let Q be the point on plane with shortest distance to point D.
Q can be expressed in \eqref{eq:10} form as
\begin{align}\label{eq:11}
	Q = \myvec{-3\\4\\-1} + \alpha_1\myvec{1\\0\\\frac{3}{2}} + \alpha_2\myvec{0\\1\\\frac{-1}{2}} 
\end{align}


Computation of Pseudo Inverse using SVD in order to determine the value of $\alpha_1$ and $\alpha_2$ :
\begin{align}
\myvec{-3\\4\\-1} + \alpha_1\myvec{1\\0\\\frac{3}{2}} + \alpha_2\myvec{0\\1\\\frac{-1}{2}} &= \myvec{-2\\2\\4}\label{eq:15}\\
\alpha_1\myvec{1\\0\\\frac{3}{2}} + \alpha_2\myvec{0\\1\\\frac{-1}{2}}  &= \myvec{1\\-2\\5}\label{eq:16}\\
\myvec{1 & 0\\0 & 1\\\frac{3}{2} & \frac{-1}{2}} \myvec{\alpha_1\\\alpha_2}  &= \myvec{1\\-2\\5}\label{eq:17}\\
M x &= b\label{eq:18}
\end{align}
Now, to solve \eqref{eq:17}, we perform Singular Value Decomposition on M as follows,
\begin{align}
M=USV^T\label{eq:19}
\end{align}
Where the columns of V are the eigen vectors of $M^TM$ ,the columns of $U$ are the eigen vectors of $MM^T$ and $S$ is diagonal matrix of singular value of eigenvalues of $M^TM$.
\begin{align}
M^TM=\myvec{\frac{13}{4}& -\frac{3}{4}\\ -\frac{3}{4}&\frac{5}{4}}\label{eq:20}\\
MM^T=\myvec{1&0& \frac{3}{2}\\0&1& -\frac{1}{2}\\ \frac{3}{2}&-\frac{1}{2}& \frac{5}{2}}
\end{align}
Putting\eqref{eq:19} in \eqref{eq:18} we get,
\begin{align}
USV^Tx & = b\\
\implies x &= VS_+U^Tb\label{eq:23}
\end{align}
Where $S_+$ is Moore-Penrose Pseudo-Inverse of $S$.Now, calculating eigen value of $MM^T$,
\begin{align}
\begin{array}{|c|}
MM^T-\lambda I
\end{array}&=0\\
\begin{array}{|ccc|}
1-\lambda & 0 & \frac{3}{2}\\\\ 0 & 1-\lambda & \frac{-1}{2} \\\\ \frac{3}{2} & \frac{-1}{2} & \frac{5}{2}-\lambda 
\end{array}&=0\\
\implies\lambda (\lambda - 1)(\lambda - \frac{7}{2}) &=0
\end{align}
Hence eigen values of $MM^T$ are,
\begin{align}
\lambda_1 &= \frac{7}{2}\\
\lambda_2 &= 1\\
\lambda_3 &= 0
\end{align}

Hence the eigen vectors of $MM^T$ are,
\begin{align}
u_1=\myvec{\frac{3}{5} \\-\frac{1}{5}\\ 1},
u_2=\myvec{\frac{1}{3}\\ 1 \\ 0 },
u_3=\myvec{-\frac{3}{2}\\ \frac{1}{2} \\ 1 },
\intertext{Normalizing the eigen vectors we get,}
u_1=\myvec{ \frac{3}{\sqrt{35}}\\ - \frac{1}{\sqrt{35}}\\\frac{5}{\sqrt{35}}},
u_2=\myvec{\frac{1}{\sqrt{10}}\\\frac{3}{\sqrt{10}}\\ 0},
u_3=\myvec{-\frac{3}{\sqrt{14}}\\ \frac{1}{\sqrt{14}}\\ \frac{2}{\sqrt{14}}}
\end{align}
Hence we obtain $U$ of \eqref{eq:19} as follows,
\begin{align}
U = \myvec{ \frac{3}{\sqrt{35}} & \frac{1}{\sqrt{10}}  &  -\frac{3}{\sqrt{14}}  \\  - \frac{1}{\sqrt{35}} & \frac{3}{\sqrt{10}}  &  \frac{1}{\sqrt{14}} \\ \frac{5}{\sqrt{35}} & 0  &  \frac{2}{\sqrt{14}} }\label{eqU}
\end{align}
After computing the singular values from eigen values $\lambda_1, \lambda_2, \lambda_3$ we get $S$ of \eqref{eq:19} as follows,
\begin{align}
S=\myvec{\sqrt{\frac{7}{2}}&0\\0&1\\0&0}\label{eq:33}
\end{align}


Now, calculating eigen value of $M^TM$,
\begin{align}
\begin{array}{|c|}
M^TM-\lambda I
\end{array}&=0\\
\begin{array}{|cc|}
\frac{13}{4}-\lambda & \frac{-3}{4}\\\\ \frac{-3}{4} & \frac{5}{4}-\lambda 
\end{array}&=0\\
\implies\lambda^2-\frac{9}{2}\lambda+\frac{7}{2} &=0
\end{align}
Hence eigen values of $M^TM$ are,
\begin{align}
\lambda_4 &= \frac{7}{2}\\
\lambda_5 &= 1
\end{align}
Hence the eigen vectors of $M^TM$ are,
\begin{align}
v_1=\myvec{-3\\1},
v_2=\myvec{ \frac{1}{3}\\ 1}
\intertext{Normalizing the eigen vectors we get,}
v_1=\myvec{-\frac{3}{\sqrt{10}}\\\frac{1}{\sqrt{10}}},
v_2=\myvec{\frac{1}{\sqrt{10}}\\\frac{3}{\sqrt{10}}}
\end{align}
Hence we obtain $V$ of \eqref{eq:19} as follows,
\begin{align}
V=\myvec{-\frac{3}{\sqrt{10}}&\frac{1}{\sqrt{10}}\\ \frac{1}{\sqrt{10}}&\frac{3}{\sqrt{10}}}
\end{align}


Finally from \eqref{eq:19} we get the Singualr Value Decomposition of $M$ as follows,
\begin{align}
M =  \myvec{ \frac{3}{\sqrt{35}} & \frac{1}{\sqrt{10}}  &  -\frac{3}{\sqrt{14}}  \\  - \frac{1}{\sqrt{35}} & \frac{3}{\sqrt{10}}  &  \frac{1}{\sqrt{14}} \\ \frac{5}{\sqrt{35}} & 0  &  \frac{2}{\sqrt{14}} }\myvec{\sqrt{\frac{7}{2}}&0\\0&1\\0&0}\myvec{\frac{3}{\sqrt{10}}&\frac{1}{\sqrt{10}}\\ -\frac{1}{\sqrt{10}}&\frac{3}{\sqrt{10}}}^T
\end{align}
Now, Moore-Penrose Pseudo inverse of $S$ is given by,
\begin{align}
S_+ = \myvec{\sqrt{\frac{2}{7}}&0&0\\0&1&0}
\end{align}
From \eqref{eq:23} we get,
\begin{align}
x = VS_+U^Tb &= \myvec{\frac{29}{14}\\\\\frac{-33}{14}}\label{eq:44}
\end{align}
Verifying the solution of \eqref{eq:44} using,
\begin{align}
M^TMx = M^Tb\label{eq:45}
\end{align}
Evaluating the R.H.S in \eqref{eq:45} we get,
\begin{align}
M^TMx &= \myvec{\frac{17}{2}\\\frac{-9}{2}}\\
\implies\myvec{\frac{13}{4}& -\frac{3}{4}\\ -\frac{3}{4}&\frac{5}{4}}x &= \myvec{\frac{17}{2}\\\frac{-9}{2}}\label{eq:47}
\end{align}



Solving the augmented matrix of \eqref{eq:47} we get,
\begin{align}
\myvec{\frac{13}{4}&-\frac{3}{4}& \frac{17}{2} \\-\frac{3}{4}&\frac{5}{4}& \frac{-9}{2}} &\xleftrightarrow[R_1\leftarrow 4R_1]{R_2\leftarrow 4R_2}\myvec{13 & -3 & 34\\ -3 & 5 & -18}\\
&\xleftrightarrow{R_2\leftarrow 13R_2}\myvec{13 & -3 & 34 \\ -39 & 65 & -234}\\
&\xleftrightarrow{R_2 \leftarrow R_2+3R_1}\myvec{13 & -3 & 34 \\ 0 & 56 & -132}
\end{align}

Hence, Solution of \eqref{eq:45} is given by,
\begin{align}
x=\myvec{\frac{29}{14}\\\\\frac{-33}{14}}\label{eq:51}
\end{align}
Comparing results of $x$ from \eqref{eq:44} and \eqref{eq:51} we conclude that the solution is verified.
\end{document}
